---
layout: post
title: "テストカバレッジ100%を目指さない理由"
date: 2019-08-02 17:47:20
updated: 2019-08-02 17:47:20
comments: true
categories:
  - ソフトウェア開発
---

テストカバレッジ100%を目指すことは、一見すると理想的な目標のように見えます。しかし、実際の開発現場では、100%のカバレッジを目指すことが必ずしも最適な選択とは限りません。

## テストカバレッジ100%の落とし穴

テストカバレッジ100%を目指すと、以下のような問題が発生する可能性があります。

### コストと時間の浪費

100%のカバレッジを達成するためには、テストが困難なコードや、実際にはほとんど実行されないエッジケースまでテストする必要があります。これらのテストを書くために費やす時間とコストは、得られる価値と比較して不釣り合いなことが多いです。

### メンテナンスコストの増加

カバレッジを100%に保つためには、コードを変更するたびに、その変更に関連するすべてのテストも更新する必要があります。特に、実装の細部に依存したテストは、リファクタリングのたびに壊れやすく、メンテナンスコストが高くなります。

### テストの質の低下

カバレッジの数値だけを追いかけると、意味のあるテストを書くよりも、カバレッジを上げるためのテストを書くことに意識が向いてしまいます。その結果、バグを発見できないテストや、将来の変更に対して脆弱なテストが増えてしまいます。

## カバレッジの数値よりも大切なこと

テストカバレッジは、テストの質を測る指標の一つに過ぎません。カバレッジの数値よりも、以下のことを重視すべきです。

### 重要な機能のテスト

ユーザーに直接影響を与える重要な機能や、ビジネスロジックの核心部分は、しっかりとテストする必要があります。一方で、単純なgetter/setterや、フレームワークが提供する機能については、テストを書かなくても問題ない場合があります。

### バグを発見できるテスト

テストの目的は、カバレッジを上げることではなく、バグを発見することです。実際にバグが発生しそうな箇所や、過去にバグが発生した箇所を重点的にテストすることが大切です。

### リファクタリングを支えるテスト

テストは、コードを安全に変更するための支えとなります。リファクタリングを支えるテストを書くことで、コードの品質を保ちながら、柔軟に変更できるようになります。

## 現実的なカバレッジ目標

100%を目指すのではなく、プロジェクトの性質やチームの状況に応じて、現実的なカバレッジ目標を設定することが大切です。

一般的には、70〜80%のカバレッジがあれば十分とされています。ただし、これはあくまで目安であり、プロジェクトによって最適な数値は異なります。重要なのは、カバレッジの数値そのものではなく、**テストが実際に価値を提供しているか**です。

## まとめ

テストカバレッジ100%を目指すことは、時間とコストを浪費し、テストの質を低下させる可能性があります。カバレッジの数値にこだわるのではなく、重要な機能をしっかりとテストし、バグを発見できるテストを書くことに集中しましょう。

テストは、コードの品質を保つための手段であり、目的ではありません。カバレッジの数値よりも、テストが実際に価値を提供しているかを常に意識することが大切です。
